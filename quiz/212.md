#### ğŸ“ [212/529] Lambda å‹å®æ•°æ®åº“ (SQS è§£è€¦)

**1. ğŸ•µï¸â€â™‚ï¸ é¢˜çœ¼ä¸çº¦æŸåˆ†æ**
* **åœºæ™¯ï¼š** Lambda (å¾®æœåŠ¡) $\\rightarrow$ On-prem SQL DB (Direct Connect)ã€‚
* **æ•…éšœï¼š** Lambda è°ƒç”¨é‡å¤§ $\\rightarrow$ æ•°æ®åº“å´©æºƒ (è¿æ¥æ•°/å¹¶å‘è¿‡é«˜)ã€‚
* **éœ€æ±‚ï¼š** Protect database from crashing (ä¿æŠ¤æ•°æ®åº“)ã€‚

**2. âš¡ ç§’æ€æ€è·¯**
* **é—®é¢˜æœ¬è´¨ï¼š** æµé‡æ´ªå³°å¯¼è‡´ DB æ— æ³•æ‰¿å—ã€‚
* **è§£å†³æ–¹æ¡ˆ 1 (æ¶æ„è§£è€¦):** å¼•å…¥ **SQS é˜Ÿåˆ—**ã€‚
    * Lambda 1 (æ¥æ”¶è¯·æ±‚) -> SQSã€‚
    * Lambda 2 (å¤„ç†è¯·æ±‚) <- SQSã€‚
    * **å…³é”®ç‚¹ï¼š** é™åˆ¶ Lambda 2 çš„ **Reserved Concurrency** (é¢„ç•™å¹¶å‘)ã€‚ä¾‹å¦‚ DB åªèƒ½æŠ— 100 ä¸ªè¿æ¥ï¼Œå°±æŠŠ Lambda 2 å¹¶å‘è®¾ä¸º 50ã€‚è¿™æ ·æ— è®º SQS ç§¯å‹å¤šå°‘æ¶ˆæ¯ï¼ŒåŒæ—¶è¿æ¥ DB çš„ Lambda æ°¸è¿œä¸ä¼šè¶…è¿‡ 50 ä¸ªï¼Œæ•°æ®åº“ç»å¯¹å®‰å…¨ã€‚ $\\rightarrow$ **é€‰ä¸­ A**ã€‚
* **è§£å†³æ–¹æ¡ˆ 2 (ä¸­é—´ä»¶):**
    * **RDS Proxy (C):** RDS Proxy åªèƒ½ä»£ç† AWS RDSï¼Œ**ä¸èƒ½**ä»£ç†æœ¬åœ°æ•°æ®åº“ (On-prem SQL DB)ã€‚æ’é™¤ã€‚
* **è§£å†³æ–¹æ¡ˆ 3 (è¿ç§»):**
    * è¿ç§»åˆ° Aurora Serverless (B) ç¡®å®èƒ½æ‰©å®¹ï¼Œä½†é¢˜ç›®é—®çš„æ˜¯"ä¿æŠ¤æ•°æ®åº“"ï¼Œé€šå¸¸æŒ‡ä¿æŠ¤ç°æœ‰æ•°æ®åº“ï¼Œæˆ–è€…è¿ç§»æˆæœ¬è¾ƒé«˜ï¼ˆDataSync è¿ç§» DB æ•°æ®ä¸æ˜¯æœ€ä½³å®è·µï¼Œé€šå¸¸ç”¨ DMSï¼‰ã€‚ä¸” A é€‰é¡¹æ˜¯ç»å…¸çš„"å‰Šå³°å¡«è°·"æ¨¡å¼ï¼Œæˆæœ¬æä½ã€‚
* **è§£å†³æ–¹æ¡ˆ 4 (SNS):**
    * SNS (D) æ˜¯æ¨é€æ¨¡å¼ï¼Œå¦‚æœæµé‡å¤§ï¼ŒSNS ä¼šç–¯ç‹‚è°ƒç”¨ Lambdaï¼ŒLambda è¿˜æ˜¯ä¼šå‹å® DBï¼ˆé™¤éè®¾äº†å¹¶å‘é™åˆ¶ï¼Œä½† D çš„å¹¶å‘é™åˆ¶æ˜¯ "Equal to connections"ï¼Œä¸‡ä¸€ DB è¿˜æœ‰å…¶ä»–è´Ÿè½½å‘¢ï¼Ÿä¸” SNS æ²¡æœ‰ç¼“å†²èƒ½åŠ›ï¼Œå¤±è´¥ä¼šä¸¢æ¶ˆæ¯/è¿› DLQã€‚SQS æœ‰ç¼“å†²ï¼Œæ›´ç¨³ï¼‰ã€‚
    * **é‡ç‚¹ï¼š** SQS çš„ç¼“å†²èƒ½åŠ›æ˜¯ä¿æŠ¤ä¸‹æ¸¸çš„æ ¸å¿ƒã€‚
    * **é”å®š Aã€‚**

**3. âœ… æ­£ç¡®é€‰é¡¹è§£æ (é€‰é¡¹ A)**
* **SQS:** ç¼“å†²æ´ªå³°ã€‚
* **Lambda Reserved Concurrency:** é™åˆ¶å¹¶å‘æ¶ˆè´¹é€Ÿåº¦ï¼Œå……å½“"èŠ‚æµé˜€"ã€‚

**5. ğŸ“š æ ¸å¿ƒè€ƒç‚¹:** Serverless æ¶æ„ä¸‹çš„æ•°æ®åº“ä¿æŠ¤æ¨¡å¼ (Throttling pattern)ã€‚