
---

#### 📝 [43/529] OpenSearch 数据分层与归档

**1. 🕵️‍♂️ 题眼与约束分析**
* **现状：** S3 $\rightarrow$ OpenSearch (10个数据节点)。
* **保留策略：** 集群内保留 1 个月用于只读分析。
* **合规需求：** 必须保留所有原始输入数据的副本 (Retain copy of all input data)。
* **痛点：** 10个节点太贵。
* **目标：** **Cost-effective**。

**2. ⚡ 秒杀思路**
* **OpenSearch 降本：**
    * 对于“只读分析”且“保留1个月”的数据，**UltraWarm** 节点是标准答案。它使用 S3 作为存储层，计算节点只做缓存，成本只有热节点的 1/10。
    * 所以架构应该是：少量 Hot 节点 (负责写入) + 大量 UltraWarm 节点 (负责那1个月的查询)。
* **原始数据归档：**
    * 输入数据在 S3 上。合规要求保留副本，但没说要频繁访问。**S3 Glacier Deep Archive** 是最便宜的归档存储。
* **秒杀动作：**
    * 选项 A: 替换所有节点为 UltraWarm。不行，UltraWarm 主要是只读的，写入性能差，通常需要 Hot 节点做前置摄取。
    * 选项 C: 引入 Cold Storage。Cold Storage 是为了把索引“冻结”（不可查询，需解冻）。题目说 "retained for analysis"（保留用于分析），意味着需要随时能查，UltraWarm 更合适。
    * 选项 D: 没提 UltraWarm，还是用普通实例，没解决成本问题。
    * **选项 B:** 减少热节点 (2个) + 添加 UltraWarm (处理容量) + 原始数据转存 Deep Archive。完美组合。
    * **锁定 B。**

**3. ✅ 正确选项解析 (选项 B)**
* **Hot-Warm Architecture:** 2个热节点负责写入，索引变旧后迁移到 UltraWarm 供分析。
* **S3 Lifecycle:** 原始数据归档到 Deep Archive 满足合规。

**5. 📚 核心考点:** OpenSearch 存储分层 (Hot/UltraWarm/Cold) 与 S3 归档。
