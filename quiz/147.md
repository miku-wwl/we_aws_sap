#### 📝 [147/529] 敏感数据脱敏 (Glue vs Lambda)

**1. 🕵️‍♂️ 题眼与约束分析**
* **输入：** 5000 records/15min (吞吐量不大)。明文 CSV。
* **敏感数据：** **PAN** (信用卡号)。
* **需求：**
    1.  **Mask PAN** (脱敏)。
    2.  Remove/Merge fields (转换)。
    3.  Convert to JSON (格式转换)。
    4.  **Easy to scale** (易扩展，未来有新源)。
* **选项对比：**
    * **A (Lambda 串联):** 这种复杂的 ETL 逻辑（提取、清洗、转换）全部手写 Lambda 代码？维护成本高，且对于数据结构的变更（Schema Evolution）支持不好。
    * **B (Fargate):** 自己写容器处理？也是造轮子。
    * **D (EMR):** 杀鸡用牛刀。5000条记录/15分钟，启动一个 EMR 集群太慢且贵。
    * **C (Glue):** **AWS Glue** 是专为 ETL 设计的。
        * **Crawler:** 自动识别 Schema（适应未来新数据源）。
        * **ETL Job:** 内置转换（FindMatches, ResolveChoice 等），且 Glue 脚本（PySpark/Python）处理 PAN 脱敏、格式转换非常容易。
        * **Trigger:** S3 Event -> Lambda -> Start Glue Job。
        * 这是最符合 "Easy to scale" 和 "Data Transformation" 场景的托管服务。
    * **锁定 C。**

**3. ✅ 正确选项解析 (选项 C)**
* **AWS Glue:** 托管 ETL，擅长 Schema 发现和复杂数据转换。

**5. 📚 核心考点:** ETL 任务选型 (Glue vs Lambda)。