#### 📝 [267/529] CodeDeploy + ASG 自动化部署 (Lifecycle Hook)

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** CodePipeline + CodeDeploy + EC2 ASG。
* **问题：** ASG 扩容（Scaling event）时，新实例需要安装 CodeDeploy Agent 并加入部署组，以便获取最新代码。
* **目标：** **Automate** deployment to new instances, **Minimize overhead**。

**2. ⚡ 秒杀思路**
* **标准集成：**
    * **CodeDeploy 与 ASG 是原生集成的**。
    * 你不需要手动写 Lambda 去关联实例 (A)。
    * 你不需要暂停 ASG (B)。
    * 你不需要每次部署都做新 AMI (C)。
* **配置方法：**
    * 只需要在 **CodeDeploy Deployment Group** 设置中，勾选对应的 **Auto Scaling Group**。
    * 并且，确保 AMI 里已经安装了 **CodeDeploy Agent** (或者通过 User Data 安装)。
    * 当 ASG 启动新实例时，CodeDeploy 会自动感知，并在实例进入 `InService` 之前，自动把最新版本的代码部署上去（利用 Lifecycle Hook 的机制，但这是托管的，无需用户配置 Hook）。
* **选项分析：**
    * 选项 A/B/C 都是"手动挡"操作，Overhead 高。
    * **选项 D:** "Create AMI with CodeDeploy Agent... Associate Deployment Group with ASG".
        * 预装 Agent 是必须的（或 UserData）。
        * 关联 Deployment Group 和 ASG 是核心配置。
        * 这样 ASG 扩容出来的实例会自动部署代码。
    * **锁定 D。**

**3. ✅ 正确选项解析 (选项 D)**
* **CodeDeploy + ASG Integration:** 原生集成，自动处理扩容实例的代码部署。
* **Baked AMI:** 预装 Agent 加速启动。

**5. 📚 核心考点:** CodeDeploy 与 Auto Scaling Group 的集成配置。