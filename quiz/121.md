#### 📝 [121/529] 遗留安全工具云上迁移 (GWLB)

**1. 🕵️‍♂️ 题眼与约束分析**
* **现状：** 本地 Legacy Security Tool (15年历史，无云原生版)。
* **迁移：** App on EC2 (Auto Scaling)。
* **需求：**
    1.  **Inspect ALL packets** (检查所有进出流量)。
    2.  **Real-time** (实时)。
    3.  **High Availability** (高可用)。
    4.  **No impact on performance** (不影响性能，透明)。
* **选择：** 2 个步骤。

**2. ⚡ 秒杀思路**
* **核心组件：** 这种"第三方防火墙设备检测流量"的场景，是 **Gateway Load Balancer (GWLB)** 的御用场景。GWLB 允许你构建一个透明的"安全设备群"，并将流量无缝引导过去再送回来（GENEVE 协议）。
* **架构设计：**
    * 选项 A (EC2 in App VPC): 这样所有流量都要手动路由到 EC2，不仅这台 EC2 会成为瓶颈，而且很难做到对 App 透明。
    * 选项 B/C (NLB/ALB): 它们是做负载均衡的，不能把流量"透明地"吸过来检测再放回去（Inline Inspection）。
    * **选项 D:** **Provide Gateway Load Balancer**。这是标准答案。
    * **选项 E:** **Provide Transit Gateway**。要实现大规模、多 VPC 甚至跨账户的流量清洗，通常结合 TGW + GWLB。虽然在单个 VPC 内可以用 GWLB Endpoint，但题目说"Design a target architecture... highly available within an AWS Region"，通常企业级流量清洗架构是 TGW (汇聚流量) + GWLB (分发给安全设备)。
    * **再看 D vs E:**
        * D 提到 "Redirect traffic to security tool"。这是 GWLB 的核心功能。
        * E 提到 "TGW for communication between VPCs"。题目说 EC2 运行在 "Dedicated VPC" (专用 VPC)，可能还有其他 VPC？或者仅仅是为了集中清洗？
        * 其实，单 VPC 也可以用 GWLB Endpoint 路由表来实现清洗。但如果有多个 VPC，TGW 是必须的。题目说 "Migrate web app from on-premises... app runs in dedicated VPC"。似乎只有一个 VPC？
        * **等等，** 题目最后一句：**"Solutions Architect should take which combination of steps?"**
        * 如果只有一个 VPC，我们是否需要 TGW？不一定。
        * 但是，**Legacy Security Tool** 通常运行在 EC2 上（Vendor Appliance）。为了高可用，这些 Appliance 需要放在 **Auto Scaling Group** 里。
        * 那么选项 A (Security tool in ASG) 是对的吗？
        * **GWLB 架构：** GWLB 后面挂的目标组（Target Group）就是这堆安全设备 EC2。
        * 所以：
            1.  **A:** 部署安全工具到 ASG。这是基础（要有机器跑工具）。
            2.  **D:** 部署 GWLB 将流量重定向到安全工具。这是核心。
        * **E** (TGW) 只有在多 VPC 互联时才必须。单 VPC 场景下，GWLB Endpoint 足以拦截流量。
        * **结论：** A (提供计算资源) + D (提供流量调度)。
    * **锁定 A, D。**

**3. ✅ 正确选项解析 (选项 A, D)**
* **A:** 将遗留安全工具部署在 EC2 ASG 中，确保高可用和扩展性。
* **D:** 使用 GWLB 作为入口，透明地将流量分发给安全工具组进行检查。

**4. ❌ 错误选项排查**
* **选项 B/C:** 传统的 ELB 不支持 Inline 透明流量检查（需要修改路由表下一跳，且不支持健康检查这种特殊场景，GWLB 专为此生）。

**5. 📚 核心考点:** Gateway Load Balancer (GWLB) 的使用场景 (第三方防火墙集成)。