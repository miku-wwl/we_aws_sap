#### 📝 [242/529] CodeCommit 凭证泄露自动修复 (3选)

*(注：原题似乎是多选，但这里只列了单选格式，或者是组合？题目描述是 "Which solution..." 看起来像单选。但下方答案选项 A, B, C, D 都是独立方案。如果必须选一个，应该是最自动化的。)*
*(更正：题目可能是多选题的变体，或者要求选一个最佳方案。)*

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** Access Key 提交到了 CodeCommit 代码库。
* **目标：** **Automatically find and remediate** (自动发现并修复)。
* **动作：** 确保凭证安全（禁用/轮换）。

**2. ⚡ 秒杀思路**
* **发现机制：**
    * 选项 A (SSM Run Command): 扫描开发实例？代码在 CodeCommit 里，扫描实例没用。
    * 选项 C (Macie): Macie 主要扫描 S3 中的敏感数据。虽然也可以扫其他，但 CodeCommit 不是其原生目标。
    * 选项 D (CodeCommit Trigger -> Lambda): **CodeCommit 支持 Triggers** (或 EventBridge)。当有 Push 时，触发 Lambda。Lambda 可以拉取代码并扫描（使用正则表达式匹配 AK/SK）。这是最实时的。
    * 选项 B (Scheduled Lambda): 定时扫描有延迟，不仅慢，而且在此期间凭证可能已被滥用。Trigger (D) 是实时的。
* **修复机制：**
    * 选项 D: "Disable them in IAM and notify user"。这是标准的应急响应（IAM API `UpdateAccessKey` status to Inactive）。
    * 选项 B: "Generate new credentials"。这是不完整的，旧的还没禁用呢！而且生成的存 KMS？
    * **DevOps Guru for CodeGuru Reviewer:** AWS 其实有 CodeGuru Reviewer 可以扫描 Secrets。但选项没提。
    * **最佳实践：** 提交代码时触发扫描 -> 发现 -> 禁用 IAM Key -> 通知。D 选项描述了这个闭环。
    * **锁定 D。**

**3. ✅ 正确选项解析 (选项 D)**
* **CodeCommit Trigger / EventBridge:** 实时捕获代码提交。
* **Lambda:** 执行扫描逻辑和 IAM 禁用操作。

**5. 📚 核心考点:** 代码库敏感信息泄露的实时检测与响应。