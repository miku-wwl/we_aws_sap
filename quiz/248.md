#### 📝 [248/529] 动态 IP 封禁 (WAF Rate-based Rule)

**1. 🕵️‍♂️ 题眼与约束分析**
* **攻击：** Failed login attempts (登录失败尝试) 激增。
* **来源：** 500 different IPs, **changing every week** (IP 经常变)。
* **目标：** Prevent attacks, **Most operationally efficient** (最高效)。

**2. ⚡ 秒杀思路**
* **WAF 规则：**
    * **IP Set (D):** 手动维护 IP 黑名单？IP 每周变，500 个 IP 手动加太累。效率低。
    * **Rate-based Rule (B):** 基于速率的规则。可以配置"如果某个 IP 在 5 分钟内请求 `/login` 超过 100 次，自动封禁该 IP"。
        * 这不需要预先知道 IP 是什么。
        * 它自动适应 IP 的变化。
        * 完美解决"登录失败激增"这种高频攻击。
* **选项对比：**
    * A/C (Firewall Manager / Security Group): SG 有条目限制（几百条），且更新 SG 有延迟，不如 WAF 灵活。
    * **锁定 B。**

**3. ✅ 正确选项解析 (选项 B)**
* **Rate-based Rules:** 自动检测并封禁高频请求的 IP，无需人工干预。

**5. 📚 核心考点:** WAF 动态防御策略 (Rate Limiting)。