#### ðŸ“ [228/529] EKS æœ‰çŠ¶æ€åº”ç”¨è¿ç§» (Session Persistence)

**1. ðŸ•µï¸â€â™‚ï¸ é¢˜çœ¼ä¸Žçº¦æŸåˆ†æž**
* **åº”ç”¨ï¼š** Web (Session Persistence) + App (Shared Data) + DBã€‚
* **è¿ç§»ï¼š** Containerized (å®¹å™¨åŒ–) $\\rightarrow$ AWSã€‚
* **éœ€æ±‚ï¼š**
    1.  Fault tolerant, scalableã€‚
    2.  Shared data available to app servers (å…±äº«æ•°æ®)ã€‚
    3.  Session persistence (ä¼šè¯æŒä¹…æ€§)ã€‚
* **çº¦æŸï¼š** **Least ongoing operational overhead**ã€‚

**2. âš¡ ç§’æ€æ€è·¯**
* **ä¼šè¯æŒä¹…æ€§ (Session Persistence):**
    * **DynamoDB / ElastiCache:** å°† Session å­˜å…¥å¤–éƒ¨æ•°æ®åº“ï¼Œå®žçŽ°æ— çŠ¶æ€åº”ç”¨ã€‚è¿™æ˜¯æœ€ä½³å®žè·µã€‚
    * **EFS:** ä¹Ÿå¯ä»¥å­˜ Session æ–‡ä»¶ï¼Œä½†æ€§èƒ½ä¸å¦‚ DB/Cacheã€‚
* **å…±äº«æ•°æ® (Shared Data):**
    * **EFS:** å¤šä¸ªå®¹å™¨å…±äº«æ–‡ä»¶çš„æ ‡å‡†æ–¹æ¡ˆã€‚
* **å¹³å°ï¼š**
    * **EKS (C/D):** é¢˜ç›®ä¸­æ²¡æœ‰æ˜Žç¡®è¯´å¿…é¡»ç”¨ EKSï¼Œä½† C/D é€‰é¡¹éƒ½æ˜¯ EKSã€‚A/B æ˜¯ ECSã€‚
    * å¦‚æžœé¢˜ç›®åå‘ Kubernetesï¼Œé€‰ C/Dã€‚å¦‚æžœåå‘ Least Overheadï¼ŒECS Fargate (A) æ›´å¥½ã€‚
    * **ç»†çœ‹é€‰é¡¹ï¼š**
        * A (ECS Fargate + EFS + SQS for Session?): SQS å­˜ Sessionï¼ŸSession æ˜¯éšæœºè¯»å†™çš„ï¼ŒSQS æ˜¯é˜Ÿåˆ—ã€‚é”™ã€‚
        * B (ECS EC2 + Redis + EBS Multi-Attach): EBS Multi-Attach é™åˆ¶å¤šä¸”ä¸è·¨ AZã€‚å®¹é”™æ€§å·®ã€‚
        * C (EKS + EFS for Session): ç”¨æ–‡ä»¶ç³»ç»Ÿå­˜ Sessionï¼Œè™½ç„¶å¯è¡Œï¼ˆPHP ç­‰è€åº”ç”¨å¸¸ç”¨ï¼‰ï¼Œä½†æ€§èƒ½å’Œæ‰©å±•æ€§ä¸å¦‚ DBã€‚
        * **D (EKS + DynamoDB for Session + EFS for Shared Data):**
            * Session -> **DynamoDB** (é«˜æ€§èƒ½ï¼ŒServerlessï¼Œæ˜“æ‰©å±•)ã€‚
            * Shared Data -> **EFS** (å…±äº«æ–‡ä»¶)ã€‚
            * è¿™æ˜¯ä¸€ä¸ªéžå¸¸ç¨³å¥ä¸”ç¬¦åˆäº‘åŽŸç”Ÿæœ€ä½³å®žè·µï¼ˆSession å¤–ç½®åˆ° DBï¼‰çš„æž¶æž„ã€‚
    * **é”å®š Dã€‚**

**3. âœ… æ­£ç¡®é€‰é¡¹è§£æž (é€‰é¡¹ D)**
* **DynamoDB for Sessions:** æœ€ä½³å®žè·µï¼Œå®žçŽ°åº”ç”¨æ— çŠ¶æ€åŒ–ã€‚
* **EFS for Shared Files:** è§£å†³æ–‡ä»¶å…±äº«éœ€æ±‚ã€‚

**5. ðŸ“š æ ¸å¿ƒè€ƒç‚¹:** æœ‰çŠ¶æ€å®¹å™¨åº”ç”¨çš„å­˜å‚¨é€‰åž‹ (Session -> DB, File -> EFS)ã€‚