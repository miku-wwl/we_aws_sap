这道题考查的是 **CloudFront 的自定义错误页面（Custom Error Pages）** 配置。这是 AWS 中处理“前端展示友好错误信息”的最标准、最轻量级模式。

#### 📝 [10/529] CloudFront 自定义错误响应

**1. 🕵️‍♂️ 题眼与约束分析**
* **当前架构：** User $\rightarrow$ Route 53 $\rightarrow$ **CloudFront** $\rightarrow$ ALB $\rightarrow$ EC2。
* **故障现象：** 偶尔（Intermittent）返回 **502 Bad Gateway**（通常是由于后端头信息过大或格式错误导致 ALB 拒绝）。
* **核心需求：** 为访问者提供 **Custom Error Page (自定义错误页面)**，而不是原本丑陋的 ALB 502 页面。
* **关键约束：** **Least operational overhead (最少的操作开销)**。

**2. ⚡ 秒杀思路**
* **关键词匹配：**
    * 看到 **"CloudFront"** + **"502 Error"** + **"Custom Error Page"** $\rightarrow$ 必须使用 **CloudFront Custom Error Responses** 功能。
    * 看到 **"Static Page"** (错误页面通常是静态的) $\rightarrow$ 存放在 **S3** 最便宜、最稳定。
* **排除法：**
    * 选项 B 和 D：涉及 CloudWatch 报警 + Lambda 写代码修改 ALB 路由。这是“大炮打蚊子”，运维极其复杂，且修改 ALB 规则有延迟，不适合处理“偶尔”的请求级错误。
    * 选项 C：Route 53 健康检查是针对“整个端点”的。如果只是偶尔 502（大部分请求还是好的），Route 53 可能根本不会切换。即使切换，DNS 缓存也会导致大量用户仍然看到错误。
* **组合拳：**
    * 第一步：找地方放错误页面 $\rightarrow$ **S3 (选项 A)**。
    * 第二步：告诉 CloudFront 出错时去读这个页面 $\rightarrow$ **配置 CloudFront (选项 E)**。
    * **锁定 A 和 E。**

**3. ✅ 正确选项解析 (选项 A + E)**

* **选项 A (创建一个 Amazon S3 存储桶...):**
    * 这是存放静态错误页面（如 `error.html`）的最佳位置。S3 成本低、高可用，且可以作为 CloudFront 的另一个源（Origin）。
* **选项 E (通过配置 CloudFront 自定义错误页面...):**
    * **CloudFront Custom Error Responses** 是原生的配置功能。你可以设置：
        * **HTTP Error Code:** 502
        * **Customize Error Response:** Yes
        * **Response Page Path:** `/error.html` (指向 S3 中的文件)
        * **HTTP Response Code:** 200 (这是为了让浏览器认为请求成功了，展示友好的页面)
    * 这完全在 CDN 边缘层处理，不需要后端参与，不需要写代码，符合“最少运维开销”。

**4. ❌ 错误选项排查**

* **选项 B & D (Lambda 修改 ALB):**
    * *错误原因：* **运维噩梦**。针对 HTTP 错误码触发 Lambda 去修改负载均衡器的监听规则，这是极其不稳定的架构。而且 502 往往是瞬间的或针对特定请求的，修改全局路由规则会导致所有用户流量被切走，反应过激。
* **选项 C (Route 53 Failover):**
    * *错误原因：* **粒度太粗**。Route 53 无法感知单个 HTTP 请求的 502。它只能感知“服务器连不上了”。对于这种“服务器还在，只是偶尔吐 502”的软故障，Route 53 往往无能为力。

**5. 📚 核心考点与延伸**

* **本题考察点：** CloudFront 的 **Custom Error Responses** 机制。
* **架构图解：**



* **工作流程：**
    1.  用户请求 $\rightarrow$ CloudFront $\rightarrow$ ALB。
    2.  ALB 返回 **502** 给 CloudFront。
    3.  CloudFront 捕获 502，**不返回给用户**。
    4.  CloudFront 内部发起请求获取 S3 中的 `error.html`。
    5.  CloudFront 将 `error.html` 返回给用户（状态码可改为 200）。

---
**小结：**
只要架构里有 **CloudFront**，处理错误页面的最佳位置永远是 **CloudFront Custom Error Responses**。配合 **S3** 存储静态页，是标准答案。

准备好下一题了吗？