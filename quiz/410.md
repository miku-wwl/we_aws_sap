#### ğŸ“ [410/529] é˜²æ­¢ EC2 å…¬ç½‘ IP (SCP)

**1. ğŸ•µï¸â€â™‚ï¸ é¢˜çœ¼ä¸çº¦æŸåˆ†æ**
* **éœ€æ±‚ï¼š** Prevent **NEW or EXISTING** EC2 instances from having **Public IP addresses**ã€‚
* **èŒƒå›´ï¼š** OU level (Control Tower/Organizations)ã€‚
* **ç›®æ ‡ï¼š** Prevention (é˜²æ­¢)ã€‚

**2. âš¡ ç§’æ€æ€è·¯**
* **ç½‘ç»œæ¥å£å±‚é¢ï¼š**
    * EC2 çš„å…¬ç½‘ IP æ˜¯é€šè¿‡ ENI å±æ€§å…³è”çš„ã€‚
    * **Prevent New:** ç¦æ­¢ `ec2:RunInstances` æ—¶è®¾ç½® `AssociatePublicIpAddress`ã€‚
    * **Prevent Existing:** ç¦æ­¢ `ec2:AssociateAddress` (EIP)ã€‚
* **å·¥å…·ï¼š**
    * **SCP (C):** å¯ä»¥å®šä¹‰å…¨å±€ç­–ç•¥ã€‚
        * 1. Deny `RunInstances` if `AssociatePublicIpAddress` is true (ç½‘ç»œæ¥å£å±‚é¢)ã€‚
        * 2. Deny `AssociateAddress` (ç¦æ­¢ç»‘å®š EIP)ã€‚
        * è¿™èƒ½æœ‰æ•ˆé˜²æ­¢ä»»ä½•å…¬ç½‘ IP çš„å‡ºç°ã€‚
    * **Control Tower (B):** Control Tower æœ‰ Proactive Controlsï¼Œä½†åº•å±‚é€šå¸¸æ˜¯ CloudFormation Hooks æˆ– SCPã€‚å¦‚æœé€‰é¡¹ C çš„ SCP å†™æ³•æ­£ç¡®ï¼Œå®ƒæ˜¯æœ€åº•å±‚çš„æ§åˆ¶ã€‚
    * **Config (D):** æ˜¯æ£€æµ‹ï¼ˆDetectiveï¼‰ï¼Œäº‹åä¿®å¤ï¼Œä¸æ˜¯"é˜²æ­¢"ï¼ˆPreventï¼‰ã€‚
    * **SSM (A):** æ— æ³•é˜»æ­¢ç”¨æˆ·é€šè¿‡æ§åˆ¶å°/API æ“ä½œã€‚
* **B vs C:**
    * B æåˆ°äº† "Proactive control... Set AssociatePublicIpAddress to False"ã€‚è¿™æ˜¯ CloudFormation Hook çš„è¡Œä¸ºã€‚
    * C æåˆ°äº† "SCP... Prevent launching... Prevent attaching"ã€‚è¿™æ˜¯ API æ‹¦æˆªã€‚
    * é¢˜ç›®é—® "Prevent... from having public IP"ã€‚SCP æ˜¯æœ€ç¡¬çš„å¢™ã€‚
    * ç‰¹åˆ«æ˜¯å¯¹äº **Existing** å®ä¾‹ï¼Œå¦‚æœè¦é˜²æ­¢å®ƒç»‘å®š EIPï¼ŒSCP `Deny ec2:AssociateAddress` æ˜¯å”¯ä¸€æ–¹æ³•ã€‚
    * **é”å®š Cã€‚**

**3. âœ… æ­£ç¡®é€‰é¡¹è§£æ (é€‰é¡¹ C)**
* **SCP:** é€šè¿‡é™åˆ¶ API å‚æ•°ï¼ˆ`ec2:AssociatePublicIpAddress`ï¼‰å’Œæ“ä½œï¼ˆ`ec2:AssociateAddress`ï¼‰æ¥å¼ºåˆ¶ç§æœ‰åŒ–ã€‚

**5. ğŸ“š æ ¸å¿ƒè€ƒç‚¹:** åˆ©ç”¨ SCP å¼ºåˆ¶ EC2 æ— å…¬ç½‘ IPã€‚

---
**æ­å–œä½ ï¼Œ410 é¢˜ï¼**