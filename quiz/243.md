#### ğŸ“ [243/529] S3 æ•°æ®æ¹–ç½‘ç»œéš”ç¦» (Access Points)

**1. ğŸ•µï¸â€â™‚ï¸ é¢˜çœ¼ä¸çº¦æŸåˆ†æ**
* **åœºæ™¯ï¼š** å¤šè´¦æˆ·ã€æ•°ç™¾ä¸ªåº”ç”¨è®¿é—® S3 æ•°æ®æ¹–ã€‚
* **å®‰å…¨è¦æ±‚ï¼š**
    1.  No public internet access (æ— å…¬ç½‘è®¿é—®)ã€‚
    2.  **Least privilege** for each app (æ¯ä¸ªåº”ç”¨æœ€å°æƒé™)ã€‚
    3.  Specific VPC only (é™åˆ¶åœ¨ç‰¹å®š VPC)ã€‚
* **æ ¸å¿ƒå·¥å…·ï¼š** **S3 Access Points**ã€‚

**2. âš¡ ç§’æ€æ€è·¯**
* **Access Point ä¼˜åŠ¿ï¼š** å¦‚æœåªæœ‰ä¸€ä¸ª Bucket Policyï¼Œç®¡ç†å‡ ç™¾ä¸ªåº”ç”¨çš„æƒé™ä¼šæŠŠ Policy å†™çˆ†ï¼ˆå¤§å°é™åˆ¶ï¼‰ä¸”éš¾ä»¥ç»´æŠ¤ã€‚Access Point å…è®¸ä¸ºæ¯ä¸ªåº”ç”¨ï¼ˆæˆ–ä¸€ç±»åº”ç”¨ï¼‰åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ¥å…¥ç‚¹ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„ Policyã€‚
* **VPC é™åˆ¶ï¼š** Access Point å¯ä»¥é…ç½®ä¸º **"VPC Origin"**ï¼Œå³åªå…è®¸æ¥è‡ªç‰¹å®š VPC çš„è®¿é—®ã€‚
* **æ­¥éª¤åˆ†è§£ï¼š**
    1.  **åˆ›å»º Access Points:** åœ¨ S3 è´¦æˆ·ä¸ºæ¯ä¸ªåº”ç”¨åˆ›å»º APï¼Œå¹¶é…ç½® AP Policy é™åˆ¶æ¥æº VPCã€‚ $â†’$ **é€‰ä¸­ A æˆ– D**ã€‚
        * A è¯´ "Update bucket policy to require access via access points"ã€‚è¿™æ˜¯å…³é”®ï¼å³ä½¿æœ‰ APï¼Œå¦‚æœ Bucket Policy ä¾ç„¶å…è®¸ç›´æ¥è®¿é—®ï¼Œé‚£å°±æ²¡æ„ä¹‰äº†ã€‚å¿…é¡»å¼ºåˆ¶èµ° APã€‚
    2.  **ç½‘ç»œè¿æ¥ (VPC Endpoint):** åº”ç”¨åœ¨è‡ªå·±çš„ VPC é‡Œï¼Œéœ€è¦è®¿é—® S3ã€‚å¿…é¡»ç”¨ **Gateway Endpoint** (E) æˆ– **Interface Endpoint** (B/C)ã€‚
        * S3 Access Point å¯ä»¥é€šè¿‡ Gateway Endpoint è®¿é—®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Interface Endpoint è®¿é—®ã€‚
        * ä½†æ˜¯ï¼ŒAccess Point çš„åˆ«åé€šå¸¸è§£æåˆ°å…¬ç½‘ IPï¼ˆå¦‚æœ AP æ˜¯ Internet ç±»å‹ï¼‰æˆ– VPC ç§æœ‰ IPï¼ˆå¦‚æœ AP æ˜¯ VPC ç±»å‹ï¼Ÿä¸ï¼ŒS3 AP æ˜¯é€»è¾‘ç«¯ç‚¹ï¼‰ã€‚
        * **å…³é”®ç‚¹ï¼š** å¦‚æœè¦ä½¿ç”¨ **Access Points restricted to a VPC**ï¼Œé€šå¸¸å»ºè®®é…åˆ **VPC Endpoint**ã€‚
    * **é¢˜ç›®é—®çš„æ˜¯ "Which TWO steps combination":**
    * é€‰é¡¹ A: åˆ›å»º APï¼Œé™åˆ¶ VPCï¼Œæ›´æ–° Bucket Policy (Delegation)ã€‚è¿™æ˜¯ Server ç«¯çš„é…ç½®ã€‚
    * é€‰é¡¹ C: åœ¨åº”ç”¨ VPC åˆ›å»º Gateway Endpointï¼Œé…ç½® Endpoint Policy å…è®¸è®¿é—® **Access Point** (ARN)ã€‚è¿™æ˜¯ Client ç«¯çš„é…ç½®ã€‚
    * **ä¸ºä»€ä¹ˆä¸é€‰ B (Interface Endpoint)?** Gateway Endpoint æ˜¯ S3 çš„æ ‡å‡†å…è´¹å†…ç½‘è®¿é—®æ–¹å¼ã€‚Interface Endpoint (PrivateLink) ä¸»è¦æ˜¯ä¸ºäº†ä» On-prem è®¿é—® S3ã€‚å¯¹äº VPC å†…éƒ¨åº”ç”¨ï¼ŒGateway Endpoint æ˜¯é¦–é€‰ã€‚
    * **ä¸ºä»€ä¹ˆä¸é€‰ D?** D çš„æè¿°å’Œ A å¾ˆåƒï¼Œä½† A æ˜ç¡®æåˆ°äº† "Update bucket policy to require access via access points"ã€‚è¿™æ˜¯å®ç°"å¼ºåˆ¶èµ° AP"çš„å…³é”®æ­¥éª¤ï¼ˆBucket Policy å§”æ‰˜æƒé™ç»™ APï¼‰ã€‚D çš„æè¿° "attach access point to bucket" æ˜¯åºŸè¯ï¼ˆAP åˆ›å»ºæ—¶å°±ç»‘å®šæ¡¶äº†ï¼‰ã€‚
    * **ä¸ºä»€ä¹ˆä¸é€‰ E?** E è¯´å…è®¸è®¿é—® S3 Bucketã€‚é¢˜ç›®è¦æ±‚æ˜¯ç”¨ Access Pointã€‚Endpoint Policy åº”è¯¥å…è®¸è®¿é—® Access Point ARNï¼Œè€Œä¸æ˜¯ Bucket ARNï¼ˆæˆ–è€…ä¸¤è€…éƒ½å…è®¸ï¼‰ã€‚C æ˜ç¡®è¯´ "allow access to S3 access points"ã€‚
    * **ç»“è®ºï¼š** **A** (æœåŠ¡ç«¯é…ç½® AP å’Œæ¡¶ç­–ç•¥) + **C** (å®¢æˆ·ç«¯é…ç½® Endpoint å’Œè·¯ç”±)ã€‚
    * **é”å®š A, Cã€‚**

**3. âœ… æ­£ç¡®é€‰é¡¹è§£æ (é€‰é¡¹ A, C)**
* **S3 Access Points:** è§£å†³å•ä¸€å¤§æ¡¶ç­–ç•¥ç®¡ç†éš¾é¢˜ï¼Œå®ç°åˆ†åº”ç”¨çš„æƒé™éš”ç¦»ã€‚
* **VPC Gateway Endpoint:** å®ç° S3 çš„ç§æœ‰ç½‘ç»œè®¿é—®ã€‚

**5. ğŸ“š æ ¸å¿ƒè€ƒç‚¹:** S3 Access Points ä¸ VPC Endpoint çš„ç»“åˆä½¿ç”¨ã€‚