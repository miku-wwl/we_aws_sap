#### 📝 [450/529] 多账户成本数据分析 (Athena + Lambda 分发)

**1. 🕵️‍♂️ 题眼与约束分析**
* **环境：** Organizations。
* **数据：** Central CUR (Cost and Usage Report) in S3 (Mgmt Account)。
* **需求：**
    1.  Member accounts query their own data via **Athena**。
    2.  **Access ONLY their own data** (数据隔离)。
* **目标：** **Minimal operational complexity**。

**2. ⚡ 秒杀思路**
* **挑战：** 中央 CUR 文件是一个大文件（或一系列文件），包含所有账户数据。Athena 无法直接对 CSV/Parquet 文件行级进行 IAM 权限控制（S3 是对象级权限）。
* **解决方案：** 必须将数据**拆分**。
    * **选项 B:**
        * S3 Event -> Lambda。
        * Lambda 解析 CUR，**extract data for each account** (按账户拆分)。
        * 将拆分后的数据存入 S3 的不同 **Prefix** (e.g. `/account-1/`, `/account-2/`)。
        * 设置 Bucket Policy，允许成员账户只访问自己的 Prefix。
        * 成员账户在自己的 Athena 中查询这个 Prefix。
* **选项对比：**
    * A (RAM): RAM 不能共享 S3 对象内容的一部分。
    * C (Cost Explorer): 题目要求用 **Athena**。且 Cost Explorer 可能没有 CUR 原始数据那么详细。
    * D (New Bucket + CUR Delivery): 配置每个成员账户都有自己的 CUR？这需要在每个账户开 CUR，比较繁琐，且失去了中央 CUR 的统一性。不过如果是"Set up CUR to deliver to new bucket"，意味着每个账户自己配 CUR。这违反了"Central CUR already available"的语境，且管理几百个 CUR 配置很麻烦。选项 B 是基于现有中央 CUR 的处理。
    * **B 选项** 是处理多租户数据分发的标准模式（Split and Scatter）。
    * **锁定 B。**

**3. ✅ 正确选项解析 (选项 B)**
* **Data Splitting:** Lambda 将集中数据拆分到租户专用前缀。
* **Prefix-level Permission:** 实现 S3 数据隔离。

**5. 📚 核心考点:** 共享 S3 数据集的行级/租户级隔离实现。