#### 📝 [266/529] S3 图像损坏检测 (S3 Event Notifications)

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** 第三方工具上传图像到 S3。CloudFront 分发。
* **问题：** 图片损坏。
* **已有资源：** Python 检测逻辑。
* **目标：** Integrate detection logic with **least latency** (最小延迟集成检测)。

**2. ⚡ 秒杀思路**
* **检测时机：**
    * **上传时 (Ingestion):** 图片一上传就检测。如果坏了，标记或删除。
    * **下载时 (Serving):** 用户请求时检测。
* **选项对比：**
    * **选项 A/B (Lambda@Edge):** 在 Viewer/Origin Response 触发。这意味着每次用户访问图片，都要运行 Python 逻辑去检测？这会显著增加**用户访问延迟**（Latency）。而且如果图片很大，Lambda@Edge 有大小和时间限制，可能跑不完。
    * **选项 C (S3 Event Notifications -> Lambda):**
        * 上传完成 (`PutObject`) $\\rightarrow$ 触发 Lambda (运行 Python 逻辑)。
        * 这是**异步**的。上传后几秒内就能发现。
        * 如果发现损坏，可以删除对象或打标签（CloudFront 配合 WAF 或 Origin Group 可以屏蔽坏图）。
        * 这种方式**不影响用户下载路径的延迟**。虽然"发现"有几秒延迟，但题目问的是 "Integrate... with least latency"，通常指不影响主业务流程（Serving）的延迟。或者指"尽快发现"。
    * **选项 D (Step Functions):** 也可以，但 Lambda (C) 更直接，更轻量。Step Functions 引入了额外的状态转换开销。
* **决策：** 只有 **异步处理 (S3 Event)** 才能避免阻塞用户下载，符合高性能架构原则。Lambda@Edge 做这种 CPU 密集型/IO 密集型任务（下载并扫描图片）是反模式。
* **锁定 C。**

**3. ✅ 正确选项解析 (选项 C)**
* **S3 Event Notification:** 异步触发，解耦检测逻辑与用户访问，零用户延迟。

**5. 📚 核心考点:** S3 事件驱动的数据处理架构。