#### 📝 [96/529] (图片题) KMS 策略权限缺失调试

*注：题目编号 96 对应图片 `image_25faa6.png`。*

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** 客户端加密 (Client-side encryption)。
* **IAM Policy 内容：**
    * S3 权限: `GetObject`, `PutObject` 等。
    * KMS 权限: `kms:Decrypt`, `kms:Encrypt`。
* **故障：** 上传新对象时报错 **Access Denied / Forbidden**。
* **关键点：** 这是 **Client-side encryption**。
    * 加密过程：客户端请求 KMS 生成一个**数据密钥 (Data Key)** $\rightarrow$ 客户端用明文 Data Key 加密文件 $\rightarrow$ 客户端丢弃明文 Data Key，将密文 Data Key 和密文文件一起上传到 S3。
* **缺失的权限：** 客户端需要让 KMS **生成数据密钥**。这个 API 叫 `kms:GenerateDataKey`。
* **当前策略：** 只有 `kms:Encrypt` 和 `kms:Decrypt`。`kms:Encrypt` 是用来直接加密小数据的（<4KB），不用于生成数据密钥。对于 S3 对象加密（信封加密），必须用 `GenerateDataKey`。
* **锁定 A。**

**3. ✅ 正确选项解析 (选项 A)**
* **kms:GenerateDataKey:** 信封加密的核心 API。客户端加密必须要有这个权限才能拿到加密用的密钥。

**5. 📚 核心考点:** KMS 信封加密 (Envelope Encryption) 所需的权限。