#### 📝 [253/529] Graviton 迁移与 ASG 优化 (R6g)

**1. 🕵️‍♂️ 题眼与约束分析**
* **现状：** 12 个 `r6g.16xlarge` (Graviton2 内存优化)。
* **监控：** CPU/Memory 利用率只有 **1/4** (25%)。
* **需求：** **Cost-effective** (省钱) + **Dynamic scaling** (动态扩展)。

**2. ⚡ 秒杀思路**
* **Right-sizing (规格调整):**
    * 当前：16xlarge。利用率 1/4。
    * 目标：16 / 4 = **4xlarge**。
    * 实例系列：原为 `r6g` (内存优化)。题目没说应用特性变了，只说资源利用率低，所以应保持 **R 系列**（内存优化），因为如果换成 C 或 M，内存可能不够（虽然利用率低，但内存是硬指标，如果还没超过 C/M 的比例，可以换。但最稳妥是降规格不换系列）。
    * **Graviton:** 原来用 `g` 系列，现在继续用 `g` 系列性价比最高。
* **容量配置：**
    * 原来 12 台，利用率 25%。这意味着只需要 3 台 16xlarge 的算力。或者 12 台 4xlarge 的算力。
    * 题目问 "Configure ASG"。
    * 如果换成 **4xlarge**（大小是原来的 1/4），那么为了维持总容量不变，数量应该是原来的 1 倍？不，原来利用率只有 25%，说明**总容量严重过剩**。
    * 实际上，如果单台 16xlarge 利用率 25%，那么单台 4xlarge 利用率将是 100%。
    * 为了留有余地（ASG 动态扩展），我们应该设置一个合理的 Min/Max。
    * 原来 12 台 16xlarge。
    * 实际负载 = 3 台 16xlarge = 12 台 4xlarge。
    * **选项 C:** `r6g.4xlarge`。Min=3, Desired=3, Max=12。
        * 3 台 4xlarge = 0.75 台 16xlarge。这连原来的 1/10 负载都扛不住？
        * **等等，** 题目说 "Consumed CPU and memory was approximately 1/4 of what was expected"。
        * 这句话有点歧义。是说利用率只有 25%？还是说利用率是"预期"的 1/4（而预期如果是 80%，那实际就是 20%）。
        * 总之，资源严重过剩。
    * **让我们换个角度：**
        * 当前：12 * 16xlarge。
        * 实际负载：3 * 16xlarge（假设 25% 利用率）。
        * 换算成 4xlarge：3 * 4 = 12 台 4xlarge。
        * 如果选 C (Max=12)，那勉强够。但 Min=3 有点少。
    * **再看 D:** `r6g.8xlarge` (一半大小)。Min=2, Max=6。
        * Max=6 * 8xlarge = 3 * 16xlarge。这正好等于当前的"实际负载"。但这没有余量了。
    * **有没有可能题目意思是：单台实例利用率低？**
    * 是的。所以要缩小实例规格 (Scale Down)。
    * 从 16xlarge 降到 4xlarge 是合理的（降 4 倍）。
    * 此时，如果请求量不变，单台 4xlarge 的利用率会变成 100%。
    * 为了维持健康（比如 50% 利用率），需要多少台？
    * 之前 12 台 16xlarge (25%) = 3 台 16xlarge (100%)。
    * = 12 台 4xlarge (100%)。
    * = 24 台 4xlarge (50%)。
    * **这里的计算有点对不上选项。**
    * 让我们重新审视 "1/4 of what was expected"。
    * 也许公司预期需要 12 台，结果发现只需要 3 台（1/4）？
    * 如果只需要 3 台 16xlarge。
    * 那么换成 4xlarge 的话，需要 12 台。
    * 选项 C (Max=12) 看起来是上限。
    * **或者，** 这里的 "1/4" 指的是单台实例的规格太大。
    * 如果我们将规格缩小到 4xlarge（1/4 大小），那么单台实例的利用率就会达到 100%（如果数量不变）。
    * 题目问 "Most cost-effective"。
    * **C 选项：** `r6g.4xlarge`。
    * **D 选项：** `r6g.8xlarge`。
    * 考虑到负载 "became more variable"（波动大），更小的实例（4xlarge）组成的集群比大实例（8xlarge/16xlarge）颗粒度更细，扩缩容更平滑，更省钱。
    * **结论：** 选 C。不仅规格合适（R6g），而且利用了 ASG 的弹性。

**3. ✅ 正确选项解析 (选项 C)**
* **Right-sizing:** 16xlarge -> 4xlarge，提高单机资源利用率。
* **ASG:** 适应波动负载。

**5. 📚 核心考点:** EC2 实例规格调整与 ASG 容量规划。