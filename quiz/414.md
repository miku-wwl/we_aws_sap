#### 📝 [414/529] IoT 设备生产注册 (JITP / JITR)

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** 生产传感器，颁发 X.509 证书（私有 CA）。
* **需求：** 设备安装后才能发送数据（即设备首次连接时自动注册）。
* **机制：** **Just-in-Time Provisioning (JITP)** 或 **Just-in-Time Registration (JITR)**。

**2. ⚡ 秒杀思路**
* **JITP 流程：**
    1.  将 CA 证书注册到 AWS IoT。
    2.  配置 **Provisioning Template** (预置模板)。
    3.  设备首次连接（带证书）时，AWS IoT 自动根据模板创建 Thing, Policy, Certificate。
* **参数验证：**
    * 题目要求验证 `SerialNumber`。
    * JITP 支持在模板中使用 **Lambda Hook** (Pre-provisioning hook) 来验证参数。
* **选项对比：**
    * **C:** Create Lambda for validation. Create Provisioning Template. Add Lambda as hook. Register CA with `allow-auto-registration`。
        * 这是标准的 **JITP** 流程。`allow-auto-registration` 开启后，设备带证书连接会触发注册流程。Lambda Hook 负责验证。
    * A: "Call RegisterThing API during production"。这是 **Bulk Provisioning** (批量预置)。题目暗示设备是"安装后"才发数据（即首次连接时注册），且 A 需要在生产线调用 API，不如 JITP 灵活（设备到现场才激活）。
    * B: Step Functions? JITP 模板不支持直接调 Step Functions，只支持 Lambda。
    * D: "Grant permission to update IoT device"? 描述模糊。
    * **关键：** JITP 是 IoT 设备大规模生产和注册的最佳实践。选项 C 的步骤最完整。
    * **锁定 C。**

**3. ✅ 正确选项解析 (选项 C)**
* **IoT Just-in-Time Provisioning (JITP):** 利用 CA 证书和预置模板实现设备首次连接时的自动注册和验证。

**5. 📚 核心考点:** AWS IoT 设备入网与证书认证流程。

---
**恭喜你，414 题！**