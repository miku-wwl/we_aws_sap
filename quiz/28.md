
---

#### 📝 [28/529] 多域名重定向服务

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** 10 个域名，根据 JSON 配置重定向到不同 URL。
* **需求：** HTTP & HTTPS，操作最少。
* **核心组件：** **ALB** 或 **CloudFront** 或 **S3**。但涉及到 HTTPS 和 10 个证书。

**2. ⚡ 秒杀思路**
* **关键点：** HTTPS 需要证书。10 个域名。
* **架构选择：**
    * 选项 A/C/D 都是后端逻辑。但前端谁来扛 HTTPS？
    * 选项 E/F 提到了 CloudFront/ACM。
    * **重定向逻辑：** 输入 URL $\rightarrow$ 查 JSON $\rightarrow$ 返回 301/302。这是一个非常轻量的逻辑，适合 ALB 或 Lambda。
* **最强组合 (ALB):**
    * ALB 支持 **Host-based Routing** (基于主机的路由) 和 **Redirection Actions** (重定向动作)。但题目说重定向规则在 JSON 里，ALB 的规则数有限制（虽然后来增加了，但管理 JSON 还是代码方便）。
    * **最省事方案：** 只有 **ALB** 原生支持 HTTP 和 HTTPS 监听器，并且可以完美集成 **ACM** (SSL 证书)。ALB 后面挂一个 **Lambda** 处理 JSON 逻辑是最简单的。
* **选项筛选（三项）：**
    * 1. 必须要处理 HTTPS $\rightarrow$ **F (ACM 证书)**。
    * 2. 必须要有个入口接收流量 $\rightarrow$ **B (ALB 监听器)**。
    * 3. 必须要有逻辑处理 JSON $\rightarrow$ **C (Lambda)**。ALB 可以把 Lambda 作为目标（Target）。
* **为什么不选 API Gateway (D)?** API Gateway 配置 Custom Domain 需要一个个配，10 个域名配 10 次，还得配证书，比较繁琐。ALB 可以在一个 Listener 上挂一张包含多个 SAN (Subject Alternative Name) 的证书，或者 SNI 挂多张证书，然后统一把流量扔给 Lambda。
* **为什么不选 EC2 (A)?** 运维麻烦。

**3. ✅ 正确选项解析 (选项 B, C, F)**
* **ACM:** 搞定证书。
* **ALB:** 搞定 HTTP/HTTPS 卸载和路由。
* **Lambda:** 搞定业务逻辑（读 JSON 返回 URL）。

**5. 📚 核心考点:** ALB + Lambda 实现轻量级微服务。
