#### 📝 [263/529] EMR 集群成本优化 (Spot Instances)

**1. 🕵️‍♂️ 题眼与约束分析**
* **场景：** EMR 集群，关键任务。
* **当前：** 全 On-Demand。
* **运行：** 每天凌晨 1:00，运行 6 小时。
* **约束：** **Time is NOT a priority** (时间不敏感)。
* **目标：** Minimize compute cost。

**2. ⚡ 秒杀思路**
* **EMR 节点类型策略：**
    * **Master Node:** 集群大脑，不能挂。必须 **On-Demand** (或 RI/SP)。
    * **Core Nodes:** 存储 HDFS 数据，挂了会丢数据（虽然有复制，但风险高）。通常建议 **On-Demand** (或 RI/SP)，或者至少一部分 OD。
    * **Task Nodes:** 只计算不存数据。挂了无所谓（任务重试）。非常适合 **Spot Instances**。
* **选项对比：**
    * 选项 A: Master/Core 用 Spot？风险太大，Master 挂了整个集群就没了。
    * 选项 C: 全 On-Demand？最贵。
    * **选项 B:** Master/Core 用 On-Demand (稳定)，Task 用 Spot (省钱)。
        * **Savings Plan:** 购买 Compute SP 覆盖 On-Demand 部分（因为每天跑 6 小时，属于稳定规律负载，或者如果是 24/7 的 Master 更好，但即使是每天 6 小时，SP 也能省钱，如果是 Compute SP）。
        * "Terminate cluster after processing"。这是 EMR 的标准 Transient Cluster 模式。
    * **选项 D:** "Terminate only Task nodes"? 既然任务跑完了，Master/Core 留着干嘛？浪费钱。应该整个集群终止（Transient）。
    * **锁定 B。**

**3. ✅ 正确选项解析 (选项 B)**
* **Master/Core (On-Demand/SP):** 保证集群稳定性。
* **Task (Spot):** 极致压榨计算成本。
* **Transient Cluster:** 用完即毁，不为空闲付费。

**5. 📚 核心考点:** EMR 集群的节点类型与购买选项最佳实践。