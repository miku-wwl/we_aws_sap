#### ğŸ“ [480/529] CloudFormation è·¨è´¦æˆ·è§’è‰²ä¿¡ä»»é—®é¢˜ (Principal Update)

**1. ğŸ•µï¸â€â™‚ï¸ é¢˜çœ¼ä¸çº¦æŸåˆ†æ**
* **åœºæ™¯ï¼š** Account A (Parent) has Role X. Account B (Child) launches EC2 via CFN.
* **é…ç½®ï¼š** EC2 in Account B assumes Role X in Account A.
* **é—®é¢˜ï¼š** CFN launched in Child account, EC2 cannot assume Role X (Insufficient permissions)ã€‚
* **åŸå› ï¼š** Role X çš„ **Trust Policy** ä¸­ï¼ŒåŸæœ¬å¯èƒ½åªä¿¡ä»»äº†æ—§ç¯å¢ƒçš„ EC2 Role æˆ– Account A çš„èµ„æºã€‚ç°åœ¨ EC2 åœ¨ Account Bï¼ŒTrust Policy å¿…é¡»æ˜¾å¼ä¿¡ä»» **Account B** (çš„ Role æˆ– Root)ã€‚

**2. âš¡ ç§’æ€æ€è·¯**
* **IAM ä¿¡ä»»ç­–ç•¥ (Trust Policy):**
    * å†³å®šäº†"è°"å¯ä»¥ Assume è¿™ä¸ª Roleã€‚
    * è¦å…è®¸ Account B çš„ EC2 Assume Account A çš„ Roleï¼ŒAccount A çš„ Role Trust Policy å¿…é¡»åŒ…å«ï¼š
        * `Principal: { "AWS": "arn:aws:iam::AccountB-ID:root" }` (æˆ–å…·ä½“ Role)ã€‚
    * **é€‰é¡¹ B:** "Add a statement... allowing `sts:AssumeRole` for the **root principal of the child account**"ã€‚è¿™æ˜¯è·¨è´¦æˆ·ä¿¡ä»»çš„æ ‡å‡†é…ç½®ã€‚
    * **é€‰é¡¹ A:** "Ensure existing... target role ARN is correct"ã€‚Trust Policy ä¸åŒ…å« Target Role ARNï¼ˆé‚£æ˜¯ Identity Policy é‡Œçš„ Resourceï¼‰ã€‚Trust Policy åŒ…å«çš„æ˜¯ Principalã€‚A æè¿°é”™è¯¯ã€‚
    * **é€‰é¡¹ C/D (Capabilities):** è¿™æ˜¯ CFN åˆ›å»º IAM èµ„æºæ—¶çš„å‚æ•°ï¼Œè·Ÿè·¨è´¦æˆ·ä¿¡ä»»é€»è¾‘æ— å…³ã€‚
* **é”å®š Bã€‚**

**3. âœ… æ­£ç¡®é€‰é¡¹è§£æ (é€‰é¡¹ B)**
* **Trust Policy Principal:** å¿…é¡»åŒ…å«è°ƒç”¨è€…æ‰€åœ¨çš„è´¦æˆ·ï¼ˆå­è´¦æˆ· Rootï¼‰ã€‚

**5. ğŸ“š æ ¸å¿ƒè€ƒç‚¹:** è·¨è´¦æˆ· IAM Role ä¿¡ä»»ç­–ç•¥çš„é…ç½®ç»†èŠ‚ã€‚