#### 📝 [173/529] S3 公开访问监控 (EventBridge)

**1. 🕵️‍♂️ 题眼与约束分析**
* **目标：** 当 S3 Bucket **becomes publicly exposed** (变公开) 时通知安全团队。
* **工具：** EventBridge + SNS。
* **核心难点：** 如何精准检测"变公开"？

**2. ⚡ 秒杀思路**
* **事件源选型：**
    * **CloudTrail (C):** `PutBucketPolicy` 只是说修改了策略，不代表"变公开"。你需要解析 Policy 内容才能知道是不是公开，EventBridge 简单的过滤器做不到这一点（需要 Lambda）。
    * **AWS Config (D):** `NON_COMPLIANT` 是配置合规性检查。如果配置了规则 `s3-bucket-public-read-prohibited`，当桶变公开时，Config 会标记为不合规。EventBridge 可以监听 Config 的合规性变更事件。这是可行的，但可能有延迟。
    * **IAM Access Analyzer (B):** Access Analyzer 专门用于**分析资源策略**，通过逻辑推理判断"是否允许了外部/公开访问"。它生成的 Finding 就是明确告诉你"这个资源被公开了"。
    * **S3 Event Notification (A):** S3 自身事件（如 PutObject）不包含"配置变更"或"公开性检查"。
* **B vs D:**
    * Access Analyzer (B) 是专门干这个的（Active Analysis）。它能生成 Finding，且直接集成 EventBridge。
    * 选项 B 的过滤器 `isPublic: true` 是 Access Analyzer Finding 的标准属性。这比 Config 更直接地针对"外部访问"这一意图。
    * **锁定 B。**

**3. ✅ 正确选项解析 (选项 B)**
* **IAM Access Analyzer:** 专门检测资源策略导致的外部访问风险。
* **EventBridge Rule:** 过滤 Access Analyzer 的 `isPublic` 发现。

**5. 📚 核心考点:** S3 公开访问的实时检测工具 (Access Analyzer)。