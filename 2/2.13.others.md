# 混合云网络（SAP考试）遗漏考点大全（新手友好版）


## 一、考点1：VPN系列（Site-to-Site VPN/Client VPN）—— 混合网络的“灵活补充”
之前重点讲了DX，但VPN是混合网络的“基础款”，SAP考试必考“VPN与DX的区别”“VPN冗余设计”：

### 1. 核心VPN类型及定位
| VPN类型               | 核心用途                          | 对应AWS组件                          | 通俗比喻                  |
|-----------------------|-----------------------------------|---------------------------------------|---------------------------|
| Site-to-Site VPN（站点到站点） | 本地数据中心/分支办公室 ↔ AWS VPC | 本地VPN设备 + AWS VGW（虚拟专用网关） | “企业间的专用VPN隧道”      |
| Client VPN            | 远程员工（笔记本） ↔ AWS VPC      | Client VPN Endpoint + 证书认证        | “员工出差的VPN账号”        |

### 2. 关键考点（必考！）
#### ① Site-to-Site VPN的核心特征
- 连接逻辑：本地VPN设备（如Cisco路由器）与AWS VGW建立**IPsec VPN隧道**（加密传输），走公网（区别于DX的私有链路）；
- 冗余设计：默认创建**2条VPN隧道**（连到VGW的两个不同 Availability Zone），避免单隧道故障（SAP架构题常考“如何提高VPN可用性”）；
- 带宽限制：单隧道带宽最高**1.25Gbps**（远低于DX），适合中小规模数据传输（如分支办公室接入）；
- 与DX的关系：可与DX形成“主备架构”（DX为主链路，VPN为备用链路），这是SAP经典高可用架构。

#### ② Client VPN的核心考点
- 认证方式：支持Active Directory、证书认证（考试常考“Client VPN的认证选项”）；
- 部署位置：Client VPN Endpoint部署在VPC的**公有子网**（需对外提供接入）；
- 适用场景：远程员工访问VPC内资源（如开发人员远程连接测试服务器）。

#### ③ 考试陷阱
- 错误选项：“Site-to-Site VPN只能创建1条隧道”“Client VPN部署在私有子网”“Site-to-Site VPN带宽高于DX”；
- 正确选项：“Site-to-Site VPN默认双隧道冗余”“Client VPN支持AD认证”“VPN走公网，DX走私有链路”。


## 二、考点2：TGW路由表—— 精细控制“流量走向”（架构题细节）
之前讲了TGW是“中央路由器”，但SAP考试会深入考“TGW如何通过路由表实现访问控制”——这是区分基础和进阶的关键考点：

### 1. 核心概念
TGW的路由表是**Region级资源**，每个TGW可以创建多个路由表，通过“附件关联路由表”实现：
- 附件（Attachment）：VPC、VGW、DXGW、跨Region TGW对等连接，都属于TGW的“附件”；
- 路由表关联：每个附件只能关联1个路由表，不同路由表之间相互隔离（类似VPC的路由表）。

### 2. 必考场景：用TGW路由表实现“隔离与互通”
- 场景1：生产VPC和测试VPC连到同一个TGW，但不想互通 → 给生产VPC和测试VPC分别关联“生产路由表”和“测试路由表”，路由表中不添加对方的IP段；
- 场景2：本地DC通过DXGW连TGW，只想访问生产VPC，不能访问测试VPC → 在DXGW对应的附件关联“生产路由表”，仅包含生产VPC的IP段路由。

### 3. 考试陷阱
- 错误选项：“TGW只能有1个路由表”“TGW附件可以关联多个路由表”“跨Region TGW对等连接不需要路由表转发”；
- 正确选项：“TGW支持多路由表，实现资源隔离”“每个TGW附件仅能关联1个路由表”“TGW路由表需手动添加或通过BGP学习路由”。


## 三、考点3：网络安全—— Security Groups/NACLs/Flow Logs（混合网络的“安全屏障”）
混合网络不仅要“通”，还要“安全”，SAP考试必考“混合网络场景下的安全控制”，核心围绕3个组件：

### 1. 核心安全组件及混合网络应用
| 安全组件       | 核心作用                          | 混合网络场景应用                          | 考点关键词                  |
|----------------|-----------------------------------|-------------------------------------------|-----------------------------|
| Security Groups（安全组） | 实例级防火墙（允许/拒绝流量）      | 1. 入站/出站端点的安全组放行UDP/TCP 53（DNS）；<br/>2. VPC内EC2的安全组放行本地DC的IP段 | 状态ful、实例级、允许规则    |
| NACLs（网络ACL） | 子网级防火墙（允许/拒绝流量）      | 私有子网的NACLs放行DX/VPN链路的IP段流量    | 无状态、子网级、允许/拒绝规则 |
| VPC Flow Logs（流量日志） | 捕获VPC内流量（谁访问、访问什么）  | 排查混合网络连通性问题（如DNS流量是否通过端点） | 存储到S3/CloudWatch Logs    |

### 2. 必考考点
- 安全组的“状态ful”特性：允许入站流量后，对应的出站响应流量会自动放行（考试常考“安全组与NACLs的区别”）；
- NACLs的“无状态”特性：需要同时配置入站和出站规则（如允许本地DC的IP段入站，也要允许对应的出站流量）；
- Flow Logs的用途：仅用于“监控和排查问题”，不能拦截流量（错误选项：“Flow Logs可以拒绝恶意流量”）。

### 3. 考试陷阱
- 错误选项：“NACLs是状态ful的”“Security Groups可以拒绝特定IP段”“Flow Logs能拦截流量”；
- 正确选项：“Security Groups是实例级、状态ful”“NACLs是子网级、无状态”“Flow Logs用于流量监控，存储到S3或CloudWatch”。


## 四、考点4：冗余与高可用—— 混合网络的“容灾设计”（架构题高频）
SAP考试非常看重“高可用架构”，混合网络的冗余设计主要涉及3个维度，必须掌握：

### 1. 核心冗余场景及解决方案
| 冗余场景               | 解决方案（SAP考试标准答案）                          | 考点关键词                  |
|------------------------|-----------------------------------------------------|-----------------------------|
| DX链路冗余             | 1. 同一DX Location创建2条DX连接（LAG链路聚合）；<br/>2. 不同DX Location创建多条DX连接（跨机房冗余） | LAG、多DX Location          |
| VPN链路冗余            | Site-to-Site VPN默认双隧道（跨AZ）；<br/>多Region部署VGW，实现跨Region VPN冗余 | 双隧道、跨Region VGW        |
| TGW冗余                | 跨Region部署TGW，通过TGW对等连接实现冗余；<br/>关键附件（如DXGW）关联多个TGW（主备） | 跨Region TGW、主备附件      |
| DNS冗余                | Route 53 Resolver端点部署在多个AZ的私有子网（至少2个AZ） | 多AZ部署、端点冗余          |

### 2. 经典架构（SAP必考）
- 架构：本地DC → 2条DX连接（不同运营商、不同DX Location）→ DXGW → 2个Region的TGW（跨Region对等）→ 多AZ VPC；
- 考点：“该架构如何实现高可用？” → 多DX链路（避免单链路故障）、多Region TGW（避免单Region故障）、多AZ VPC（避免单AZ故障）。

### 3. 考试陷阱
- 错误选项：“DX只能创建1条连接，无法冗余”“TGW跨Region对等连接不支持冗余”“Route 53 Resolver端点只需部署1个AZ”；
- 正确选项：“DX支持LAG链路聚合实现冗余”“TGW跨Region对等连接可实现跨Region冗余”“Resolver端点需部署在至少2个AZ的私有子网”。


## 五、考点5：VPC Endpoints—— 混合网络的“私有访问AWS服务”（隐藏考点）
VPC Endpoints虽然不属于“混合网络连接”，但常与混合网络结合考查（比如本地DC通过DX访问S3，是否需要走公网），是SAP的“隐藏高频考点”：

### 1. 核心概念
VPC Endpoints是VPC与AWS服务（如S3、DynamoDB、ECR）之间的**私有连接**，流量不经过公网，直接通过AWS骨干网传输。

### 2. 与混合网络的结合考点
- 场景：本地DC通过DX → DXGW → TGW → VPC Endpoints → S3；
- 考点：“本地DC访问S3的私有路径” → 无需走公网，通过VPC Endpoints实现私有访问（安全且稳定）；
- 关键配置：TGW路由表中需添加VPC Endpoints的IP段路由，确保本地DC的流量能转发到VPC Endpoints。

### 3. 考试陷阱
- 错误选项：“本地DC访问S3必须走公网”“VPC Endpoints需要部署在公有子网”“VPC Endpoints不能通过TGW访问”；
- 正确选项：“本地DC可通过DX+TGW+VPC Endpoints私有访问S3”“VPC Endpoints部署在私有子网”“VPC Endpoints支持通过TGW对外（本地DC）提供访问”。


## 六、考点6：BGP协议—— 混合网络的“路由交换”（基础考点）
之前讲DX、VPN时都提到了BGP，但没深入讲——SAP考试会考查BGP的核心作用，不会考复杂配置：

### 1. 核心作用（通俗版）
BGP（边界网关协议）是混合网络中“交换路由信息的语言”：
- 本地DC ↔ DX/AWS：通过BGP交换“本地IP段”和“AWS VPC IP段”，让双方知道“如何到达对方”；
- TGW ↔ DXGW/VGW：通过BGP学习路由，无需手动配置所有路由（减少管理复杂度）。

### 2. 关键考点
- 自治系统号（ASN）：AWS侧默认使用169.254.x.x的ASN，企业侧可使用自己的ASN（考试常考“BGP的ASN配置”）；
- 路由聚合：BGP支持路由聚合（将多个小IP段合并为一个大IP段），减少路由表大小；
- 冗余性：BGP支持“多路径路由”，当有多条链路（如双DX连接）时，可实现负载均衡或故障切换。

### 3. 考试陷阱
- 错误选项：“BGP不能用于DX连接”“AWS侧ASN不能修改”“BGP不支持路由聚合”；
- 正确选项：“BGP是混合网络中路由交换的核心协议”“DX和VPN都支持BGP”“BGP支持多路径路由实现冗余”。


## 七、SAP混合网络考点总清单（终极复习）
### 核心组件（已讲）
- 网关：VGW/DXGW/TGW（定位、连接方式、传递路由）；
- DX：VIF类型（Private/Public/Transit）、带宽、运营商对接；
- DNS：Route 53 Resolver（入站/出站端点、转发规则）。

### 遗漏考点（新增）
1. VPN：Site-to-Site VPN（双隧道冗余）、Client VPN（认证、部署位置）；
2. TGW路由表：多路由表实现隔离、附件关联规则；
3. 网络安全：Security Groups/NACLs/Flow Logs的区别与应用；
4. 高可用：DX/VPN/TGW/DNS的冗余设计；
5. VPC Endpoints：混合网络中私有访问AWS服务；
6. BGP协议：路由交换、ASN、路由聚合。

### 备考建议
- 重点抓“架构题高频考点”：VPN冗余、TGW路由表隔离、混合网络高可用架构、VPC Endpoints+DX访问S3；
- 陷阱题重点记：安全组与NACLs的区别、BGP的作用、Resolver端点的部署位置；
- 综合题思路：遇到“混合网络+安全+高可用”的综合题，先拆解“连接组件（DX/VPN/TGW）+ 安全组件（安全组/NACLs）+ 冗余设计（多链路/多AZ）”，再对应选项排除错误答案。
