# SAP考试安全模块核心考点详解（必背+真题落地）
这部分是AWS安全模块的「得分精华」，直接覆盖SAP考试安全题型80%的考点，每个考点都结合「核心逻辑+考试题型+真题示例+易混淆点」，帮你从“死记硬背”升级为“灵活秒杀”：


## 一、共享责任模型（所有安全题的“底层逻辑”）
### 核心逻辑：
AWS安全是“用户和AWS共同负责”，**任何安全场景题，先明确责任边界**—— 这是SAP考试的“送分题”，也是“陷阱题”的高频来源。

#### 责任边界划分（考试必记，用表格秒杀）
| 责任方                | 核心责任（考试关键词）                          | 典型示例（题干常考）                          |
|-----------------------|---------------------------------------------------|---------------------------------------|
| AWS责任（“安全的云”） | 基础设施安全（数据中心、服务器、网络硬件）、服务本身的安全性（如KMS的密钥存储安全） | “谁负责AWS数据中心的物理安全？”→ AWS；“谁负责KMS的HSM硬件安全？”→ AWS |
| 用户责任（“云中的安全”） | 数据加密（静态+传输）、身份权限管理（IAM）、安全组/NACLs配置、应用层防护（WAF）、漏洞修复 | “谁负责加密S3存储的数据？”→ 用户；“谁负责配置EC2的安全组规则？”→ 用户；“谁负责修复EC2的CVE漏洞？”→ 用户 |

#### 考试陷阱（必避坑）：
- ❌ 误区：“AWS负责用户数据的加密”→ 错！用户数据加密是用户责任（AWS仅提供KMS等加密工具）；
- ❌ 误区：“用户负责AWS服务器的系统补丁”→ 错！服务器硬件/系统补丁是AWS责任（用户仅需负责EC2实例内部的操作系统补丁）；
- ✅ 口诀：“AWS管‘地基’（基础设施），用户管‘房子’（数据、权限、配置）”。

#### 真题示例：
**题目**：以下哪项是AWS用户的安全责任？（单选）  
A. AWS数据中心的物理门禁管理  
B. S3存储的客户数据加密  
C. KMS服务的硬件安全模块（HSM）维护  
D. EC2服务器的底层硬件故障修复  
**答案**：B  
**解析**：A/C/D均为AWS责任，用户需负责自身数据的加密。


## 二、服务选型题（高频！题干关键词→直接锁定答案）
这是SAP考试最高频的题型（每10道安全题占4-5道），核心是“题干关键词→匹配服务核心功能”，结合之前学习的细节，补充「选型逻辑+陷阱」：

### 1. KMS相关选型（加密+跨区域）
| 题干关键词                | 正确答案                          | 易混淆错误选项                          |
|---------------------------|-----------------------------------|---------------------------------------|
| 数据加密+跨区域DR/全局表   | KMS多区域密钥（MRK）              | 单区域CMK、BYOK（陷阱：忽略“跨区域”需求） |
| 合规要求“完全控制密钥材料”  | BYOK（客户自有密钥）               | AWS托管CMK（陷阱：无法自主管控密钥）    |
| 密钥需禁用/删除/自定义轮换  | 用户托管CMK                       | AWS托管CMK（陷阱：无法禁用/删除）      |
| 低成本+免管理+默认加密     | AWS托管CMK（aws/xxx）              | 用户托管CMK（陷阱：需支付存储费）      |

#### 真题示例：
**题目**：某跨国公司使用DynamoDB全局表跨us-east-1和ap-southeast-2同步数据，要求数据加密且密钥可跨区域直接解密，应选择哪种CMK？  
**答案**：KMS多区域密钥（MRK）  
**解析**：关键词“全局表+跨区域+直接解密”，单区域CMK跨区域需导入密钥材料，不符合“直接解密”需求。

### 2. 凭证/配置存储选型
| 题干关键词                | 正确答案                          | 易混淆错误选项                          |
|---------------------------|-----------------------------------|---------------------------------------|
| RDS/Redshift密码自动轮换   | Secrets Manager                   | Parameter Store（陷阱：不支持原生自动轮换） |
| 普通配置参数（URL/端口）+ 低成本 | Parameter Store（基础参数免费） | Secrets Manager（陷阱：成本高，无需轮换） |
| 敏感凭证+跨账户访问       | Secrets Manager（需KMS+资源策略） | Parameter Store（陷阱：权限控制较弱）    |

#### 真题示例：
**题目**：某公司需要管理100个非敏感的应用配置参数（如API地址、端口号），要求成本最低，应选择哪种服务？  
**答案**：Parameter Store  
**解析**：关键词“非敏感+配置参数+成本最低”，Secrets Manager适用于需轮换的敏感凭证，成本更高。

### 3. 边缘防护选型
| 题干关键词                | 正确答案                          | 易混淆错误选项                          |
|---------------------------|-----------------------------------|---------------------------------------|
| Web应用防护（SQLi/XSS/速率限制） | WAF                               | Shield Advanced（陷阱：仅防DDoS，不防应用层攻击） |
| 大规模DDoS（10Gbps+）+ 扩容费用免除+专业支持 | Shield Advanced | Shield Basic（陷阱：无法抵御大规模攻击） |
| 多账户统一WAF/安全组规则   | Firewall Manager（需Organizations） | 手动在每个账户配置WAF（陷阱：不符合“多账户统一管控”需求） |

#### 真题示例：
**题目**：某电商平台在双11期间面临以下风险：① SQL注入攻击；② 100Gbps容量型DDoS攻击；③ 攻击期间EC2 Auto Scaling扩容需免除费用。应选择哪些服务组合？  
**答案**：WAF + Shield Advanced + CloudFront  
**解析**：① 需WAF防应用层攻击；②+③ 需Shield Advanced防大规模DDoS+免扩容费；CloudFront作为边缘节点，叠加防护。

### 4. 威胁检测/漏洞扫描选型
| 题干关键词                | 正确答案                          | 易混淆错误选项                          |
|---------------------------|-----------------------------------|---------------------------------------|
| 账户级威胁检测（异常登录/恶意IP/S3数据泄露） | GuardDuty（被动日志分析） | Inspector（陷阱：仅扫描实例漏洞，不检测账户威胁） |
| EC2实例/ECR镜像漏洞扫描（CVE/合规配置） | Inspector（主动扫描） | GuardDuty（陷阱：不扫描漏洞，仅告警） |
| 分布式应用调用链路追踪（性能/故障排查） | X-Ray | GuardDuty（陷阱：非安全服务，不检测威胁） |

#### 真题示例：
**题目**：某公司需要定期扫描运行中EC2实例的操作系统漏洞（如Log4j），并获取修复建议，应选择哪种服务？  
**答案**：Inspector（主机评估，需安装代理）  
**解析**：关键词“EC2实例+漏洞扫描+修复建议”，GuardDuty仅检测威胁，不扫描漏洞。


## 三、权限配置题（核心条件+必记步骤）
这类题常以“配置题”“故障排查题”出现，核心是“记住配置的必要条件”，缺一不可：

### 1. Secrets Manager跨账户访问（必考双授权）
#### 核心条件（两者必须同时满足）：
- ① 资源方（账户B）的Secrets Manager **资源策略** 允许账户A的IAM角色访问；
- ② 资源方（账户B）的KMS CMK（加密凭证的CMK）**密钥策略** 允许账户A的IAM角色解密（若使用自定义CMK）。

#### 考试陷阱：
- ❌ 误区：“仅配置Secrets Manager的资源策略即可跨账户访问”→ 错！若凭证用自定义CMK加密，必须同时配置KMS密钥策略；
- ✅ 必记：“Secrets Manager跨账户=资源策略+KMS密钥策略”（多选/判断题高频）。

#### 真题示例：
**题目**：账户A的应用需要访问账户B的Secrets Manager中的RDS密码（该凭证用账户B的自定义CMK加密），以下哪些配置是必须的？（多选）  
A. 账户B的Secrets Manager资源策略允许账户A的IAM角色访问  
B. 账户A的IAM角色附加允许访问该凭证的IAM策略  
C. 账户B的CMK密钥策略允许账户A的IAM角色解密  
D. 在账户A和B之间创建VPC Peering  
**答案**：AC  
**解析**：跨账户访问需资源方双授权（A+C）；B是主体方授权，题干未提账户A的IAM角色无权限，默认已有；D无需网络连接。

### 2. Firewall Manager管控（必考前提）
#### 核心条件：
- ① 必须依赖 **AWS Organizations**（组织）；
- ② 仅能由组织的 **管理账户** 配置，成员账户无配置权限；
- ③ 成员账户需接受组织管理，启用“组织访问权限”。

#### 考试陷阱：
- ❌ 误区：“Firewall Manager可以管控独立账户（未加入Organizations）”→ 错！仅支持Organizations内账户；
- ❌ 误区：“成员账户可以修改Firewall Manager推送的安全规则”→ 错！强制应用，成员账户无法修改。

#### 真题示例：
**题目**：某公司有10个独立的AWS账户（未加入Organizations），需要统一配置WAF规则，以下方案可行的是？（单选）  
A. 使用Firewall Manager创建WAF策略  
B. 手动在每个账户创建相同的WAF Web ACL  
C. 将所有账户加入Organizations后，使用Firewall Manager  
D. 启用GuardDuty自动同步WAF规则  
**答案**：B  
**解析**：A/C需Organizations，题干未加入；DGuardDuty不负责同步WAF规则；仅B可行（虽然繁琐，但符合题干条件）。


## 四、原理题（核心步骤+关键细节）
这类题考查对服务底层逻辑的理解，无需记复杂细节，聚焦“核心步骤+区别点”：

### 1. 信封加密原理（必考步骤）
#### 核心逻辑（3步加密+3步解密）：
- **加密流程**：  
  1. 调用`GenerateDataKey` API → KMS返回「明文DEK + 加密后的DEK」；  
  2. 本地用「明文DEK」加密原始数据（大/小数据均可）；  
  3. 存储「加密后的原始数据 + 加密后的DEK」（信封），销毁明文DEK；  
- **解密流程**：  
  1. 调用`Decrypt` API → 用CMK解密「加密后的DEK」→ 得到明文DEK；  
  2. 本地用「明文DEK」解密「加密后的原始数据」；  
  3. 销毁明文DEK。

#### 考试陷阱：
- ❌ 误区：“CMK直接加密大文件”→ 错！CMK仅加密DEK（≤4KB），大文件需用DEK加密；
- ✅ 必记：“DEK加密数据，CMK加密DEK”（口诀秒杀原理题）。

#### 真题示例：
**题目**：以下关于信封加密的说法，正确的是？（单选）  
A. CMK直接加密GB级原始数据  
B. 明文DEK需存储在S3桶中  
C. 加密后的原始数据和加密后的DEK需绑定存储  
D. 解密时无需CMK，直接用DEK解密  
**答案**：C  
**解析**：A错误（CMK仅加密DEK）；B错误（明文DEK用完销毁，不存储）；D错误（需CMK解密密文DEK）。

### 2. WAF核心原理
#### 必记考点：
- 防护层级：OSI 7层（仅支持HTTP/HTTPS协议）；
- 支持对象：CloudFront、ALB、API Gateway、AppSync（不支持NLB、EC2直接部署）；
- 规则执行逻辑：优先级从高到低，终止性动作（Allow/Block/Captcha）执行后，后续规则不再处理。

#### 真题示例：
**题目**：WAF可以部署在以下哪些AWS资源上？（多选）  
A. NLB（网络负载均衡）  
B. ALB（应用负载均衡）  
C. CloudFront（CDN）  
D. EC2实例（直接部署）  
**答案**：BC  
**解析**：WAF仅支持7层资源，NLB是4层（A错误），EC2需通过ALB转发（D错误）。

### 3. GuardDuty数据来源
#### 必记考点（核心日志来源）：
- CloudTrail（管理事件+数据事件）：检测异常登录、权限滥用；
- VPC Flow Logs：检测恶意IP通信、端口扫描；
- S3访问日志：检测S3数据泄露、未授权访问；
- DNS查询日志：检测恶意DNS解析。

#### 考试陷阱：
- ❌ 误区：“GuardDuty需要安装代理收集数据”→ 错！依赖AWS原生日志，无需代理；
- ❌ 误区：“GuardDuty能检测EC2实例内部的恶意进程”→ 错！仅分析日志，不深入实例内部（需Inspector）。

#### 真题示例：
**题目**：GuardDuty检测到“EC2实例与已知恶意IP通信”，该检测依赖哪种日志？（单选）  
A. CloudTrail管理日志  
B. VPC Flow Logs  
C. S3访问日志  
D. X-Ray调用日志  
**答案**：B  
**解析**：VPC Flow Logs记录网络流量的源IP/目标IP，是检测恶意IP通信的核心数据来源。


## 五、总结：秒杀SAP安全题的“终极口诀”
1. 责任划分：AWS管基建，用户管数据/权限/配置；
2. 选型口诀：  
   - 加密跨区用MRK，合规自有选BYOK，免管低成本用托管CMK；  
   - 密码轮换SM，配置参数PS，Web防护WAF，DDoS高级SA；  
   - 多账户管控FM，威胁检测GD，漏洞扫描Inspector；
3. 权限口诀：跨账户访问双授权（资源策略+KMS/IAM策略），FM依赖Organizations；
4. 原理口诀：信封加密DEK加密数据、CMK加密DEK，WAF7层防Web攻击，GD日志来检测。