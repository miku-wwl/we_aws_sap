# 核心结论先明确：
Serverless场景（Lambda/EKS+Fargate）的实例是 **AWS托管** 的（无需用户管理底层计算/网络资源），API Gateway与它们的通信通过 **AWS内部私有网络/用户VPC原生网络** 实现，无需额外配置VPC Link/Private Endpoint——这两个服务是为“跨网络边界通信”设计的（如公网→用户VPC内EC2），而Serverless场景的网络本身就是连通的，自然不需要。


## 一、先理清核心前提：Serverless的“托管本质”（SAP考点）
Serverless的核心定义是 **“无需管理底层计算资源（服务器/节点）”**，这里的“托管”不仅是计算资源，还包括网络资源——AWS会自动维护网络连通性，用户无需手动配置子网、路由、安全组来打通API Gateway和Serverless实例的通信。

下面分两种核心Serverless服务，拆解“托管模式+通信逻辑”：


## 二、Lambda：默认AWS托管VPC，通信无需额外通道
### 1. Lambda的托管形态（用户无需管网络）
- **默认模式**：Lambda函数创建后，默认运行在 **AWS托管的VPC** 中（这个VPC是AWS全局维护的，用户看不到、不用配置，自带高可用和网络连通性）；
- **核心特点**：用户只需要编写函数代码，无需关心“Lambda跑在哪个服务器”“网络怎么配置”，AWS自动处理扩容、网络路由、安全隔离。

### 2. API Gateway与Lambda的通信逻辑（SAP核心）
- 因为Lambda和API Gateway都是 **AWS原生服务**，它们之间的通信走 **AWS内部私有网络**（不是公网），无需经过互联网，也不需要用户配置任何网络通道（VPC Link/Private Endpoint）；
- 类比：就像同一个大楼里的两个部门，不需要走外部马路，通过内部走廊就能通信——AWS就是这个“大楼”，内部服务间的通信由AWS自动打通。

### 3. 特殊情况：Lambda需要访问用户VPC内的资源（如RDS）
- 若Lambda要访问你自己VPC内的资源（如RDS、ElastiCache），需要给Lambda配置 **“VPC访问权限”**：
  - 操作：在Lambda控制台→配置→VPC，选择你自己的VPC、私有子网、安全组；
  - 通信逻辑：此时Lambda会被“接入”你的VPC，API Gateway与Lambda的通信依然走AWS内部网络（因为Lambda已经在你的VPC里，API Gateway能通过VPC内的网络直接访问），**依然不需要VPC Link/Private Endpoint**；
  - SAP考点：这种场景下，只需配置Lambda的VPC访问，无需额外配置API Gateway的网络，这是常见的“陷阱题”（选项中若出现“配置VPC Link”，为错误答案）。


## 三、EKS+Fargate：托管节点接入用户VPC，通信走原生网络
### 1. EKS+Fargate的托管形态（用户管VPC，AWS管节点）
- Fargate是AWS托管的无服务器计算引擎，当你创建EKS集群并启用Fargate时：
  - 用户需要做的：创建自己的VPC和私有子网（用于部署Fargate节点）；
  - AWS托管的：Fargate节点本身（用户看不到、不用管理EC2节点），AWS会自动在你的VPC子网中部署Fargate节点，运行K8s Pod；
- 核心：Fargate节点属于AWS托管，但会“接入”用户的VPC，与用户VPC内的其他资源（如RDS、负载均衡器）网络互通。

### 2. API Gateway与EKS+Fargate的通信逻辑
- EKS+Fargate中的Pod，通过K8s的 **Ingress或Service** 暴露访问端点（类似“Pod的入口地址”）；
- 通信路径：API Gateway → Ingress/Service → Fargate Pod；
- 为什么不需要VPC Link？：因为Fargate节点已经接入用户的VPC，Ingress/Service的端点在用户VPC内，API Gateway（公网形态）可通过 **公网→Ingress** 访问，或通过AWS内部网络访问（若Ingress配置为私有），无需VPC Link（VPC Link是用于“公网API访问VPC内未暴露公网的服务”，而EKS+Fargate的Ingress已经是访问入口）；
- 为什么不需要Private Endpoint？：Private Endpoint是用于“内部资源访问API Gateway”，而这里是API Gateway访问EKS+Fargate，方向相反，自然不需要。


## 四、关键对比：为什么EC2需要VPC Link，而Serverless不需要？
| 服务类型                | 网络形态                          | 与API Gateway通信方式                          | 是否需要VPC Link/Private Endpoint |
|-------------------------|-----------------------------------|-----------------------------------|-----------------------------------|
| Lambda（默认）          | AWS托管VPC（AWS维护）              | AWS内部私有网络（原生连通）        | 否                                |
| Lambda（接入用户VPC）   | 运行在用户VPC内（用户配置VPC，AWS管理Lambda实例） | 用户VPC内网络（原生连通）          | 否                                |
| EKS+Fargate             | Fargate节点接入用户VPC（AWS托管节点，用户配置VPC） | 公网→Ingress/Service 或 AWS内部网络 | 否                                |
| EC2（用户VPC内）        | 运行在用户VPC内（用户管理EC2+网络） | 公网无法直接访问（需暴露公网IP/ALB） | 是（公网API访问需VPC Link）        |

### 核心原因：
- Serverless服务（Lambda/EKS+Fargate）的网络是 **“托管式连通”**：要么由AWS托管VPC保证原生连通，要么接入用户VPC后自然与外部服务连通，无需额外通道；
- EC2是 **“用户完全管理的网络”**：默认不暴露公网，公网API要访问必须通过VPC Link打通公网→用户VPC的通道，否则无法通信。


## 五、SAP真题考点映射（必记）
### 真题示例1：
“某公司使用Lambda作为API Gateway的后端，构建无服务器API，以下关于网络配置的说法正确的是？”
- 选项A：必须配置VPC Link才能让API Gateway访问Lambda → 错误；
- 选项B：Lambda默认运行在AWS托管VPC，API Gateway可直接访问 → 正确；
- 选项C：必须给Lambda配置Private Endpoint → 错误。

### 真题示例2：
“某公司使用EKS+Fargate部署微服务，通过API Gateway对外提供服务，以下哪种网络配置是必需的？”
- 选项A：VPC Link → 错误；
- 选项B：用户VPC和子网（用于部署Fargate节点） → 正确；
- 选项C：Private Endpoint → 错误。

### 关键考点：
- 记住：Serverless服务（Lambda/EKS+Fargate）与API Gateway通信 **无需VPC Link/Private Endpoint**，核心原因是“AWS托管网络或原生VPC连通”；
- 陷阱选项：题目中若出现“Serverless场景需配置VPC Link/Private Endpoint”，直接排除。


## 总结：
Serverless场景的核心优势就是“托管”——计算、网络都由AWS托管，API Gateway作为AWS原生服务，自然能通过内部网络或用户VPC的原生网络与它们通信，无需额外配置VPC Link/Private Endpoint。这也是SAP考试中区分“Serverless架构”和“传统架构”网络配置的关键考点，记住“托管=原生连通=无需额外通道”即可。