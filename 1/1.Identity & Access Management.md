**身份与访问管理 (Identity & Access Management)**。

在单账户时代，我们用 IAM User；但在 SAP 考的百倍规模多账户环境里，IAM User 是**“被嫌弃”**的。主角是 **IAM Identity Center (原 AWS SSO)**。

这一块的考点非常集中，主要围绕**“人怎么进门”**和**“进门后有什么权限”**。

### 核心考点：IAM Identity Center (AWS SSO)

请把 IAM Identity Center 想象成一个**“酒店前台”**。

#### 1. 核心逻辑三部曲

SAP 考试会考察这三个环节的配置：

* **Step 1: 身份源 (Where are the users?)**
    * **考点**：用户存在哪里？
    * **选项 A**：**Identity Center 目录**（AWS 自带的，适合小公司）。
    * **选项 B**：**Active Directory (AD)**。这是企业级考题的**标准答案**。通常结合 **AD Connector** 或 **AWS Managed Microsoft AD** 使用。
    * **选项 C**：**外部 IdP** (Okta, Ping, Azure AD)。通过 SAML 2.0 协议连接。

* **Step 2: 权限集 (Permission Sets)** —— **考试高频词！**
    * **定义**：它是 IAM Role 的**“模版”**或**“图章”**。
    * **逻辑**：你在 Identity Center 里定义一个“权限集”（比如叫 `DBAdmin`，策略是 `RDS:FullAccess`）。当你把它分配给 Account A 时，AWS 会自动在 Account A 里创建一个对应的 **IAM Role**。
    * **考点**：你**管理**的是权限集，AWS 帮你**创建**的是 IAM Role。

* **Step 3: 分配 (Assignment)**
    * **逻辑**：把 `用户(User/Group)` + `权限集(Permission Set)` + `目标账户(Account)` 绑定在一起。
    * **结果**：Bob 使用 DBAdmin 权限集登录了 Account A。

---

#### 2. 必考场景：AD 集成与权限映射

这是 SAP 考试中最经典的题目结构：
> **背景**：一家大公司，本地有 Active Directory (AD)，里面有 5000 个用户，分在不同的 AD Group（如 `Developers`, `Admins`）。
> **需求**：要求这些用户使用现有的 AD 账号登录 AWS Organizations 下的 100 个成员账户，且权限要自动匹配（Developers 组只能有只读权限，Admins 组有管理权限）。
> **约束**：**最小化管理开销**。

**解题路径（标准答案）：**

1.  **连接**：使用 **IAM Identity Center**，并将身份源设置为 **Active Directory** (通常配合 AD Connector)。
2.  **映射**：在 Identity Center 中创建 **Permission Sets**（如 `ReadOnlyAccess`, `AdministratorAccess`）。
3.  **绑定**：将 **AD Group** 直接映射到 **Permission Sets** 和 **AWS Accounts**。
    * *不要在 AWS 里创建 IAM User！*
    * *不要手动去每个账户里创建 IAM Role！*

---

#### 3. 易混淆陷阱：IAM Role vs. Permission Set

请尝试区分这两个概念，这是考试挖坑的地方：

| 概念 | 谁创建？ | 存在哪里？ | 考试怎么考？ |
| :--- | :--- | :--- | :--- |
| **Permission Set** (权限集) | 你 (管理员) | **IAM Identity Center** (管理账户中) | 题目问：“如何**集中**定义和管理跨账户的访问策略？” -> 选 Permission Set。 |
| **IAM Role** (角色) | Identity Center (自动) | **成员账户** (目标账户中) | 题目问：“用户登录后，在**目标账户**里实际扮演的是什么实体？” -> 选 IAM Role。 |

---

### 实战小测验 (Combat Drill)

**场景：**
你正在管理一个拥有 50 个账户的组织。安全团队发现 `Account A` 里的一个 IAM Role 权限过大，想要修改它。
这个 Role 是通过 IAM Identity Center 的 `Permission Set: PowerUser` 自动生成的。

**问题：**
安全工程师应该去哪里修改策略？
A. 登录 `Account A`，去 IAM 控制台直接修改那个 IAM Role 的策略。
B. 登录 `Management Account`，去 IAM Identity Center 控制台修改 `Permission Set: PowerUser`，然后重新预置。